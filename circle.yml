machine:
  ruby:
      version: 2.3.1
  hosts:
    circlehost: 127.0.0.1
    dev.mycompany.com: 127.0.0.1

dependencies:
  pre:
    - pip install --upgrade pip
    - pip install diff_cover
    - pip install dicttoxml
    - pip install coverage
    - pip install nose

database:
  override:
    - cp config/database.yml.tmp config/database.yml
    - bundle exec rake db:create db:migrate

test:
  override:
    - bundle exec thin start:
          background: true
    - bundle exec rake test
    - diff-cover $CIRCLE_ARTIFACTS/coverage.xml
